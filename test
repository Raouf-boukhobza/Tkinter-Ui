import tkinter as tk
from ttkbootstrap import *
from db_connectino import create_connection as connect_to_db
from tkinter import messagebox
import pymysql

# Insert data into the database
def insert_data():
    name = entry_name.get()
    prenom = entry_prenom.get()
    email = entry_email.get()
    numero_telephone = entry_numero_telephone.get()
    date_naissance = entry_date_naissance.get()
    nin = entry_nin.get()  
    ville = entry_ville.get()
    commune = entry_commune.get()
    type_appartement = entry_type.get()
    
    
    conn = connect_to_db()
    if conn:
        cursor = conn.cursor()
        try:
            query = "INSERT INTO users (nom , prenom , email , NumeroDeTelephone ,dateDeNaissance , NIN, ville , commenu , type) VALUES (%s, %s,%s, %s,%s, %s,%s, %s,%s )"
            cursor.execute(query, (name, prenom, email ,numero_telephone,date_naissance, nin, ville ,commune, type_appartement))
            conn.commit()
            messagebox.showinfo("Success", "Data inserted successfully!")
        except pymysql.MySQLError as e :
            messagebox.showerror("Insert Error", f"Error: {e}")
        finally:
            cursor.close()
            conn.close()


# Fetch data from the database
def fetch_data():
    conn = connect_to_db()
    if conn:
        cursor = conn.cursor()
        try:
            cursor.execute("SELECT * FROM users")
            rows = cursor.fetchall()
            for row in rows:
                listbox.insert(tk.END, row)
        except pymysql.MySQLError as e:
            messagebox.showerror("Fetch Error", f"Error: {e}")
        finally:
            cursor.close()
            conn.close()
                 

# Tkinter GUI
root = tk.Tk()
root.title("MySQL with Tkinter")

# Get the screen width and height
screen_width = root.winfo_screenwidth()
screen_height = root.winfo_screenheight()
root.geometry(f"{screen_width}x{screen_height}")

# Input fields
tk.Label(root, text="Nom:").grid(row=0, column=0, padx=10, pady=5)
entry_name = tk.Entry(root)
entry_name.grid(row=0, column=1, padx=10, pady=5)

tk.Label(root, text="Prenom:").grid(row=1, column=0, padx=10, pady=5)
entry_prenom = tk.Entry(root)
entry_prenom.grid(row=1, column=1, padx=10, pady=5)


tk.Label(root, text="Numero de telephone:").grid(row=2, column=0, padx=10, pady=5)
entry_numero_telephone= tk.Entry(root)
entry_numero_telephone.grid(row=2, column=1, padx=10, pady=5)

tk.Label(root, text="Email:").grid(row=3, column=0, padx=10, pady=5)
entry_email = tk.Entry(root )
entry_email.grid(row=3, column=1, padx=10, pady=5)


tk.Label(root, text="NiN:").grid(row=4, column=0, padx=10, pady=5)
entry_nin = tk.Entry(root)
entry_nin.grid(row=4, column=1, padx=10, pady=5)


tk.Label(root, text="date de naissance :").grid(row=5, column=0, padx=10, pady=5)
entry_date_naissance = tk.Entry(root)
entry_date_naissance.grid(row=5, column=1, padx=10, pady=5)

tk.Label(root, text="ville:").grid(row=6, column=0, padx=10, pady=5)
entry_ville = tk.Entry(root)
entry_ville.grid(row=6, column=1, padx=10, pady=5)

tk.Label(root, text="commune:").grid(row=7, column=0, padx=10, pady=5)
entry_commune = tk.Entry(root)
entry_commune.grid(row=7, column=1, padx=10, pady=5)

tk.Label(root, text="type:").grid(row=8, column=0, padx=10, pady=5)
entry_type = tk.Entry(root)
entry_type.grid(row=8, column=1, padx=10, pady=5)

# Buttons
tk.Button(root, text="Insert Data", command=insert_data).grid(row=9, column=0, columnspan=2, pady=10)
tk.Button(root, text="Fetch Data", command=fetch_data).grid(row=10, column=0, columnspan=2, pady=10)

# Data display
listbox = tk.Listbox(root, width=50)
listbox.grid(row=11, column=0, columnspan=2, pady=10)

root.mainloop()






